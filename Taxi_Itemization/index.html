<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <meta charset="UTF-8">
    <title>Taxi Itemization</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css">

<script>
  const version = 'v2.0.0'; // change this when you update
  const current = new URLSearchParams(window.location.search).get('v');

  if (current !== version) {
    const newUrl = new URL(window.location.href);
    newUrl.searchParams.set('v', version);
    window.location.replace(newUrl.toString());
  }
</script>

</head>
<body>

    
<div class="container text-center" style="margin-top: 50px;">
    
    <a href="javascript:(function()%7B(function%20()%20%7B%0A%20%20function%20waitForElement(selector)%20%7B%0A%20%20%20%20return%20new%20Promise(function%20(resolve%2C%20reject)%20%7B%0A%20%20%20%20%20%20let%20element%20%3D%20document.querySelector(selector)%3B%0A%20%20%20%20%20%20if%20(element)%20return%20resolve(element)%3B%0A%0A%20%20%20%20%20%20const%20observer%20%3D%20new%20MutationObserver(function%20()%20%7B%0A%20%20%20%20%20%20%20%20element%20%3D%20document.querySelector(selector)%3B%0A%20%20%20%20%20%20%20%20if%20(element)%20%7B%0A%20%20%20%20%20%20%20%20%20%20observer.disconnect()%3B%0A%20%20%20%20%20%20%20%20%20%20return%20resolve(element)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20observer.observe(document.documentElement%2C%20%7B%0A%20%20%20%20%20%20%20%20childList%3A%20true%2C%0A%20%20%20%20%20%20%20%20subtree%3A%20true%2C%0A%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20%20%20observer.disconnect()%3B%0A%20%20%20%20%20%20%20%20reject(new%20Error(%60Element%20%24%7Bselector%7D%20not%20found%20within%20timeout.%60))%3B%0A%20%20%20%20%20%20%7D%2C%2010000)%3B%0A%20%20%20%20%7D)%3B%0A%20%20%7D%0A%0A%20%20function%20waitForElementByXPath(xpath)%20%7B%0A%20%20%20%20return%20new%20Promise(function%20(resolve%2C%20reject)%20%7B%0A%20%20%20%20%20%20let%20element%20%3D%20document.evaluate(%0A%20%20%20%20%20%20%20%20xpath%2C%0A%20%20%20%20%20%20%20%20document%2C%0A%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20XPathResult.FIRST_ORDERED_NODE_TYPE%2C%0A%20%20%20%20%20%20%20%20null%0A%20%20%20%20%20%20).singleNodeValue%3B%0A%0A%20%20%20%20%20%20if%20(element)%20return%20resolve(element)%3B%0A%0A%20%20%20%20%20%20const%20observer%20%3D%20new%20MutationObserver(function%20()%20%7B%0A%20%20%20%20%20%20%20%20element%20%3D%20document.evaluate(%0A%20%20%20%20%20%20%20%20%20%20xpath%2C%0A%20%20%20%20%20%20%20%20%20%20document%2C%0A%20%20%20%20%20%20%20%20%20%20null%2C%0A%20%20%20%20%20%20%20%20%20%20XPathResult.FIRST_ORDERED_NODE_TYPE%2C%0A%20%20%20%20%20%20%20%20%20%20null%0A%20%20%20%20%20%20%20%20).singleNodeValue%3B%0A%0A%20%20%20%20%20%20%20%20if%20(element)%20%7B%0A%20%20%20%20%20%20%20%20%20%20observer.disconnect()%3B%0A%20%20%20%20%20%20%20%20%20%20return%20resolve(element)%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20observer.observe(document.documentElement%2C%20%7B%0A%20%20%20%20%20%20%20%20childList%3A%20true%2C%0A%20%20%20%20%20%20%20%20subtree%3A%20true%2C%0A%20%20%20%20%20%20%7D)%3B%0A%0A%20%20%20%20%20%20setTimeout(function%20()%20%7B%0A%20%20%20%20%20%20%20%20observer.disconnect()%3B%0A%20%20%20%20%20%20%20%20reject(new%20Error(%60Element%20%24%7Bxpath%7D%20not%20found%20within%20timeout.%60))%3B%0A%20%20%20%20%20%20%7D%2C%2010000)%3B%0A%20%20%20%20%7D)%3B%0A%20%20%7D%0A%0A%20%20function%20copyToClipboard(text)%20%7B%0A%20%20%20%20const%20textArea%20%3D%20document.createElement('textarea')%3B%0A%20%20%20%20textArea.value%20%3D%20text%3B%0A%20%20%20%20textArea.style.position%20%3D%20'fixed'%3B%0A%20%20%20%20textArea.style.top%20%3D%20'-100%25'%3B%0A%20%20%20%20document.body.appendChild(textArea)%3B%0A%20%20%20%20textArea.focus()%3B%0A%20%20%20%20textArea.select()%3B%0A%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20const%20successful%20%3D%20document.execCommand('copy')%3B%0A%20%20%20%20%20%20if%20(successful)%20%7B%0A%20%20%20%20%20%20%20%20console.log('Number%20copied%20to%20clipboard')%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.error('Failed%20to%20copy%20text')%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20catch%20(err)%20%7B%0A%20%20%20%20%20%20console.error('Error%20copying%20text%3A'%2C%20err)%3B%0A%20%20%20%20%7D%0A%0A%20%20%20%20document.body.removeChild(textArea)%3B%0A%20%20%7D%0A%0A%20%20function%20setNativeValue(element%2C%20value)%20%7B%0A%20%20%20%20const%20lastValue%20%3D%20element.value%3B%0A%20%20%20%20element.value%20%3D%20value%3B%0A%20%20%20%20const%20tracker%20%3D%20element._valueTracker%3B%0A%20%20%20%20if%20(tracker)%20tracker.setValue(lastValue)%3B%0A%20%20%20%20element.dispatchEvent(new%20Event('input'%2C%20%7B%20bubbles%3A%20true%20%7D))%3B%0A%20%20%20%20element.dispatchEvent(new%20Event('change'%2C%20%7B%20bubbles%3A%20true%20%7D))%3B%0A%20%20%7D%0A%0A%20%20async%20function%20automateSequence()%20%7B%0A%20%20%20%20try%20%7B%0A%20%20%20%20%20%20%2F%2F%20Step%200%3A%20Check%20if%20title%20includes%20%22Taxi%22%0A%20%20%20%20%20%20const%20titleElement%20%3D%20document.getElementById('entry-title')%3B%0A%20%20%20%20%20%20if%20(!titleElement%20%7C%7C%20!titleElement.textContent.includes('Taxi'))%20%7B%0A%20%20%20%20%20%20%20%20alert('Skipping%3A%20Entry%20is%20not%20a%20Taxi%20expense')%3B%0A%20%20%20%20%20%20%20%20return%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Step%201%3A%20Click%20%22Itemizations%22%20tab%0A%20%20%20%20%20%20const%20element1%20%3D%20await%20waitForElement('%23itemizations-tab%20%3E%20span')%3B%0A%20%20%20%20%20%20element1.scrollIntoView()%3B%0A%20%20%20%20%20%20element1.click()%3B%0A%20%20%20%20%20%20console.log('Clicked%20Itemizations%20tab')%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Step%202%3A%20Extract%20and%20copy%20amount%0A%20%20%20%20%20%20const%20element2%20%3D%20await%20waitForElement('div.row.amount-remaining.cnqr-full-width%20%3E%20div%3Anth-child(1)%20%3E%20div%20%3E%20span')%3B%0A%20%20%20%20%20%20let%20innerText%20%3D%20element2.innerText%20%7C%7C%20element2.textContent%3B%0A%20%20%20%20%20%20let%20numericValue%20%3D%20innerText.match(%2F%5B0-9.%2C%5D%2B%2Fg)%3B%0A%20%20%20%20%20%20let%20number%20%3D%200%3B%0A%0A%20%20%20%20%20%20if%20(numericValue)%20%7B%0A%20%20%20%20%20%20%20%20numericValue%20%3D%20numericValue.join('')%3B%0A%20%20%20%20%20%20%20%20number%20%3D%20parseFloat(numericValue.replace(%2F%2C%2Fg%2C%20''))%3B%0A%20%20%20%20%20%20%20%20console.log('Extracted%20Number%3A'%2C%20number)%3B%0A%20%20%20%20%20%20%20%20copyToClipboard(number.toString())%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.log('No%20numeric%20value%20found.')%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Step%203%3A%20Click%20%22Add%22%20button%0A%20%20%20%20%20%20const%20element3%20%3D%20await%20waitForElement('div.sapcnqr-toolbar.sapcnqr-toolbar--solid%20%3E%20div%20%3E%20div%20%3E%20div%20%3E%20button%3Anth-child(1)%20%3E%20span')%3B%0A%20%20%20%20%20%20element3.scrollIntoView()%3B%0A%20%20%20%20%20%20element3.click()%3B%0A%20%20%20%20%20%20console.log('Clicked%20Add%20button')%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Step%203.1%3A%20Open%20Expense%20Type%20dropdown%0A%20%20%20%20%20%20const%20buttonXPath%20%3D%20%22%2F%2Fbutton%5B%40aria-label%3D'Show%20options%20for%20Expense%20Type'%5D%22%3B%0A%20%20%20%20%20%20const%20element31%20%3D%20await%20waitForElementByXPath(buttonXPath)%3B%0A%20%20%20%20%20%20element31.scrollIntoView()%3B%0A%20%20%20%20%20%20element31.click()%3B%0A%20%20%20%20%20%20console.log('Opened%20Expense%20Type%20dropdown')%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Step%204%3A%20Select%20%22Taxi%22%0A%20%20%20%20%20%20const%20xpath1%20%3D%20%22%2F%2Fdiv%5Bnormalize-space()%20%3D%20'Taxi'%5D%22%3B%0A%20%20%20%20%20%20const%20taxiElement%20%3D%20await%20waitForElementByXPath(xpath1)%3B%0A%20%20%20%20%20%20if%20(taxiElement)%20%7B%0A%20%20%20%20%20%20%20%20taxiElement.scrollIntoView()%3B%0A%20%20%20%20%20%20%20%20taxiElement.click()%3B%0A%20%20%20%20%20%20%20%20console.log('Selected%20Taxi')%3B%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.log('Taxi%20element%20not%20found')%3B%0A%20%20%20%20%20%20%7D%0A%0A%20%20%20%20%20%20%2F%2F%20Step%205%3A%20Click%20sub-option%0A%20%20%20%20%20%20const%20xpath2%20%3D%20%22%2Fhtml%2Fbody%2Fdiv%5B9%5D%2Fdiv%2Fdiv%2Fdiv%2Fdiv%5B2%5D%2Fdiv%2Ful%5B2%5D%2Fli%5B8%5D%2Fdiv%2Fdiv%2Fdiv%22%3B%0A%20%20%20%20%20%20const%20element5%20%3D%20await%20waitForElementByXPath(xpath2)%3B%0A%20%20%20%20%20%20element5.scrollIntoView()%3B%0A%20%20%20%20%20%20element5.click()%3B%0A%20%20%20%20%20%20console.log('Clicked%20sub-option')%3B%0A%0A%20%20%20%20%20%20%2F%2F%20Step%206%3A%20Set%20transaction%20amount%0A%20%20%20%20%20%20const%20amountInput%20%3D%20await%20waitForElement('%23transactionAmount')%3B%0A%20%20%20%20%20%20if%20(amountInput)%20%7B%0A%20%20%20%20%20%20%20%20amountInput.focus()%3B%0A%20%20%20%20%20%20%20%20setNativeValue(amountInput%2C%20number.toString())%3B%0A%20%20%20%20%20%20%20%20amountInput.blur()%3B%0A%20%20%20%20%20%20%20%20console.log('Set%20amount%20input')%3B%0A%0A%20%20%20%20%20%20%20%20%2F%2F%20Step%207%3A%20Click%20%22Next%20Expense%22%20if%20enabled%0A%20%20%20%20%20%20%20%20const%20nextExpenseXPath%20%3D%20%22%2F%2Fbutton%5B%40aria-label%3D'Next%20Expense'%20and%20%40aria-disabled%3D'false'%5D%22%3B%0A%20%20%20%20%20%20%20%20const%20nextButton%20%3D%20await%20waitForElementByXPath(nextExpenseXPath)%3B%0A%20%20%20%20%20%20%20%20if%20(nextButton)%20%7B%0A%20%20%20%20%20%20%20%20%20%20nextButton.scrollIntoView()%3B%0A%20%20%20%20%20%20%20%20%20%20nextButton.click()%3B%0A%20%20%20%20%20%20%20%20%20%20console.log('Clicked%20Next%20Expense')%3B%0A%20%20%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20%20%20console.error('Next%20Expense%20button%20not%20found%20or%20disabled')%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20console.error('Amount%20input%20not%20found')%3B%0A%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%20catch%20(error)%20%7B%0A%20%20%20%20%20%20console.error(error.message)%3B%0A%20%20%20%20%7D%0A%20%20%7D%0A%0A%20%20automateSequence()%3B%0A%7D)()%3B%0A%7D)()" class="btn btn-primary" draggable="true">
  Taxi Itemization
</a>

    <img class="" style="width: 50px; height: 50px; object-fit: cover;"  src="https://external-preview.redd.it/2ll9_sVXHv7rEoiSuErGtwyrzxHzB4-CJgmkdqStCqw.jpg?auto=webp&s=f859879e63b8f970bd0e2a7fd31b7519f97757d7" alt="Drag and drop" >
    
    <img class="mb-5" style="width: 20; height: 50px;" src="https://cdn-icons-png.flaticon.com/512/20/20923.png" alt="">

<div><h4 class="text-m">Drag and Drop the above button to the bookmarks bar</p></div>
</div>


<!-- Optional JavaScript -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.bundle.min.js"></script>

</body>
</html>
